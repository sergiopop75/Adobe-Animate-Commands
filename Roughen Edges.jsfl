//Roughen Edges//Justin Putney//http://putney.ajarproductions.com//version 1.0.0var dom 		= fl.getDocumentDOM();var _dotSpace 	= .5;var _dotSize 	= "large";var _variation 	= "one size";var _density	= "very dense";var sel 		= dom.selection;var version 	= fl.version;version 		= version.split(" ")[1]; //remove OS from stringversion 		= parseInt(version.split(",")[0]);var objEnabled 	= (version > 7);//objEnabled = false; //test MX 2004function run() {	var storedStroke = dom.getCustomStroke("toolbar");		var selArr = new Array();	for(var i=0; i < sel.length; i++) {		var targ = sel[i];		var isObj = targ.isDrawingObject;		var color;		var convertedToObject = false;		if(targ.elementType != "shape") continue;		if(isObj) selArr.push(sel);		if(sel.length > 1) dom.selection = [targ];		var fillColor = dom.getCustomFill("selection").color;		color = fillColor;		var strokeColor = dom.getCustomStroke("selection").color;		if(color == undefined) color = strokeColor;		if(color == undefined) return; //exit, the selection has no stroke or fill				if(!isObj && objEnabled) {			dom.union();			convertedToObject = true;		}		if(!objEnabled && fillColor == undefined) {			runVersion7custom();					} else {			if(strokeColor != undefined) dom.convertLinesToFills();						sel[i] = dom.selection[0];			dom.setStroke(color, .5, "stipple");			var stroke = dom.getCustomStroke("selection");			stroke.color     = color;			stroke.dotSpace  = _dotSpace;			stroke.dotSize 	 = _dotSize;			stroke.variation = _variation;			stroke.density   = _density;						dom.setCustomStroke(stroke);			dom.convertLinesToFills();				if(convertedToObject) dom.unGroup(); //revert state		}		dom.selectAll();		dom.selectNone();	}		//reset stroke	if(storedStroke.style != "noStroke") {		dom.setCustomStroke(storedStroke);	} else {		var storedFill = dom.getCustomFill("toolbar");		var tempFill = dom.getCustomFill("toolbar");		tempFill.style = "noFill";		dom.setCustomFill(tempFill);		dom.swapStrokeAndFill();		dom.setCustomFill(storedFill);	}		//reselect drawing objects	dom.selection = sel;}function runVersion7custom(){	dom.group();	dom.enterEditMode();		dom.selectAll();		var originalStroke = dom.getCustomStroke("selection");		var strokeColor    = originalStroke.color;		color = strokeColor;		dom.clipCopy();		dom.clipPaste(true);		dom.group();			dom.enterEditMode();				dom.selectAll();				dom.setStroke(color, originalStroke.thickness*.98, "stipple");				dom.convertLinesToFills();			dom.exitEditMode();			dom.selectAll();		dom.unGroup();		var stroke = dom.getCustomStroke("selection");		stroke.color     = color;		stroke.dotSpace  = _dotSpace;		stroke.dotSize   = _dotSize;		stroke.variation = _variation;		stroke.density   = _density;		dom.setCustomStroke(stroke);		dom.convertLinesToFills();	dom.exitEditMode();	dom.unGroup();}run();